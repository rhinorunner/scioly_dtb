This code shoudl hae everything but still needs testing.
